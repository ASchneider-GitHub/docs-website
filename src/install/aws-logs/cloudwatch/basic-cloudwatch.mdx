---
componentType: default
headingText: Set up infrastructure agent with Fluentbit
---

## Install and configure the CloudWatch logs Lambda function [#install-function]

The following setup shows one approach for configuring environment variables. You can also configure them from the [Functions](https://docs.aws.amazon.com/lambda/latest/dg/configuration-envvars.html) page.

Complete the following:

1. Make sure you have a <InlinePopover type="licenseKey" />.
2. Open the [AWS Serverless Application Repository](https://serverlessrepo.aws.amazon.com/applications) in your browser.
3. Search for `newrelic` and check <DoNotTranslate>**Show apps that create custom IAM roles or resource policies**</DoNotTranslate> to find `newrelic-log-ingestion`.
4. Open the `newrelic-log-ingestion` details and click <DoNotTranslate>**Deploy**</DoNotTranslate>.
5. In the function's <DoNotTranslate>**Configure**</DoNotTranslate> menu, go to <DoNotTranslate>**Environment Variables**</DoNotTranslate> and configure log forwarding using the following environment variables:

    <table>
      <thead>
        <tr>
          <th style={{ width: "200px" }}>
            Key
          </th>
    
          <th>
            Description
          </th>
        </tr>
      </thead>
    
      <tbody>
        <tr>
          <td>
            `DEBUG_LOGGING_ENABLED`
          </td>
    
          <td>
            A boolean to determine if you want to output debug messages in the CloudWatch console. **Optional**.
    
            To turn on debug logs, set this to `true`. Default is `false`.
          </td>
        </tr>
    
        <tr>
          <td>
            `LICENSE_KEY`
          </td>
    
          <td>
            <InlinePopover type="licenseKey" /> is used for sending data to New Relic. **Required.**
          </td>
        </tr>
    
        <tr>
          <td>
            `LOGGING_ENABLED`
          </td>
    
          <td>
            Determines if logs are forwarded to New Relic. **Required.** To turn on logging, set this to `true`.
          </td>
        </tr>
    
        <tr>
          <td>
            `NR_TAGS`
          </td>
    
          <td>
            Specify tags to be added to all log events. **Optional**.
    
            Each tag is composed of a colon-delimited key and value. Multiple key-value pairs are semicolon-delimited; for example, `env:prod;team:myTeam`.
          </td>
        </tr>
    
        <tr>
          <td>
            `NR_LAMBDA_LOG_GROUP_PREFIX`
          </td>
    
          <td>
            If you've configured your Lambda log group to use a different path than `/aws/lambda`, you can specify it with this variable. **Optional**.
          </td>
        </tr>
    
        <tr>
          <td>
            `NR_VPC_LOG_GROUP_PREFIX`
          </td>
    
          <td>
            If you've configured your VPC log group to use a different path than `/aws/vpc/flow-log`, you can specify it with this variable. **Optional**.
          </td>
        </tr>
      </tbody>
    </table>

6. Acknowledge that the app creates custom IAM roles, and then click <DoNotTranslate>**Deploy**</DoNotTranslate>.

Once the process completes, [create a Lambda trigger](#create-trigger) to link your Lambda function to CloudWatch logs.

