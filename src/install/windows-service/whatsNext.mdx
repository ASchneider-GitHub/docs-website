---
componentType: default
headingText: Metrics collected by the integration
---


## How it works [#process]

To get data from Windows hosts, our Windows services integration uses a reduced version of the [Prometheus exporter for Windows](https://github.com/prometheus-community/windows_exporter), which exposes Prometheus metrics on the port specified in the agent configuration. The integration collects these metrics, transforms them into entities, filters them, and then sends them to New Relic.

<img
  title="Windows services integration architecture"
  alt="Windows services integration architecture"
  src={infrastructureWindowsServices}
/>

<figcaption>
  The Windows services integration collects [Service Functions](https://docs.microsoft.com/en-us/windows/win32/services/service-functions) data using the Windows Prometheus exporter. It then transforms and filters the data before sending it to New Relic.
</figcaption>

## Metric data [#metrics]

The Windows services integration provides the following data:

<Callout variant="tip">
  This integration creates dimensional metrics, which return the numeric status supplied by the [Win32_Service class](https://learn.microsoft.com/en-us/windows/win32/cimwin32prov/win32-service). Enumeration of these metrics into readable string values is provided under the `start_mode` and `state` attributes.
</Callout>

<table>
  <thead>
    <tr>
      <th>
        Metric Name
      </th>

      <th>
        Enumerated Attribute
      </th>

      <th>
        Description
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `windows_service_start_mode`
      </td>

      <td>
        `start_mode`
      </td>

      <td>
        Start mode of the service. Possible values are:

        * `boot`
        * `system`
        * `auto`
        * `manual`
        * `disabled`
      </td>
    </tr>

    <tr>
      <td>
        `windows_service_state`
      </td>

      <td>
        `state`
      </td>

      <td>
        State of the service. Possible values are:

        * `stopped`
        * `start pending`
        * `stop pending`
        * `running`
        * `continue pending`
        * `pause pending`
        * `paused`
        * `unknown`
      </td>
    </tr>
  </tbody>
</table>

## Metadata [#metadata]

The Windows services integration sends the following metadata to New Relic:

* `display_name`: Name of the service as viewed in the services snap-in.
* `process_id`: Process identifier of the service.
* `run_as`: Account name under which a service runs. Depending on the service type, the format of the account name may be `DomainName\Username` or `Username@DomainName` (UPN). The value is taken from the `StartName` attribute of the `Win32_Service` class, which can be `NULL` (in that case, the label is reported as an empty string).
* `service_name`: Unique identifier of the service.

  <Callout variant="important">
    If the `StartName` attribute is `NULL`, the service is logged on under the `LocalSystem` account. For kernel or system-level drive, it runs with a default object name created by the I/O system based on the service name, for example, `DWDOM\Admin`.
  </Callout>

## Source code [#open-source]

The Windows services integration is open source software. That means you can [browse its source code](https://github.com/newrelic/nri-winservices/) and [send improvements](https://github.com/newrelic/nri-winservices/blob/master/CONTRIBUTING.md), or create your own fork and build it. For more information, see the [README](https://github.com/newrelic/nri-winservices/blob/master/README.md).

