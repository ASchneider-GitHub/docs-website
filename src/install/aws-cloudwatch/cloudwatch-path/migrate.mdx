---
componentType: default
optiontype: task
headingText: Migrate to the CloudWatch Metric Streams integration
---

We recommend that existing customers migrate from API polling to Metric Streams using a CloudFormation template by following the instructions below.

<CollapserGroup>
    <Collapser
        id="with-template"
        title="Migrate with CloudFormation template (Recommended)"
    >
        1. Replicate the namespaces from polling into metric streams by going to <DNT>**[one.newrelic.com > All capabilities](https://one.newrelic.com/all-capabilities) > Infrastructure > AWS > Migrate to AWS Cloudwatch metric streams**</DNT>, and then configuring your AWS Metric Streams account.
        2. Download the customized CloudFormation template under the **Configure metric streams** step. This template contains the preconfigured namespaces that are based on your existing polling configuration.
        3. Add your account details to the downloaded template.
        4. In the AWS Console, upload your CloudFormation template by going to **Cloud Formation > Create Stack > Upload a template file**.

    </Collapser>
    <Collapser
        id="without-template"
        title="Migrate without CloudFormation template"
    >
        1. Go to <DNT>**[one.newrelic.com > All capabilities](https://one.newrelic.com/all-capabilities) > Infrastructure > AWS > Add an AWS account**</DNT>, then add your AWS account. This step is required even if you've already linked your AWS account with polling integrations.
        2. Enable AWS CloudWatch Metric Stream and the AWS Kinesis Data Firehose in the final step of the **Add an AWS account** process. This pushes metrics to New Relic. AWS CloudWatch requires one stream per region, so repeat this step for any additional AWS regions you want to monitor.
        3. Ensure metrics are received from all connected regions and namespaces. This may take several minutes.
        4. Disable all unnecessary polling integrations in the previous AWS provider account. Remember that [some integrations still need to be enabled](/docs/infrastructure/amazon-integrations/connect/aws-metric-stream#integrations-not-replaced-streams) because they aren't fully replaced by Metric Streams.
    </Collapser>
</CollapserGroup>

Our AWS Metric Streams integration uses the Metric API to push metrics in the [dimensional metric](/docs/data-apis/understand-data/new-relic-data-types/#dimensional-metrics) format.

Our poll-based AWS integration pushes metrics based on [events](/docs/data-apis/understand-data/new-relic-data-types/#events-new-relic) (for example, the `ComputeSample` event), and will be migrated to dimensional metrics in the future.

To assist in this transition, we provide a mechanism (known as shimming) that transparently lets you write queries in any format. Then these queries are processed as expected based on the source that's available (metrics or events). This mechanism works both ways, from events to metrics, and vice versa.

<Callout variant="tip">
  Learn more about [the limitations](/docs/query-your-data/nrql-new-relic-query-language/nrql-query-tutorials/query-infrastructure-dimensional-metrics-nrql/#known-limitations) of the query mechanism that allows customers to use event-based queries (samples) with the AWS CloudWatch Metric Stream integration (dimensional metric format).
</Callout>

Please consider the following when migrating from our poll-based integrations:

* <DNT>**Dashboards**</DNT>: Custom <InlinePopover type="dashboards"/> that use poll-based AWS integration events will still work as expected.
* <DNT>**Alerts**</DNT>: Alert conditions that use poll-based AWS events will still work. We recommend adapting those to the dimensional metric format (using NRQL as source).
* <DNT>**Entities**</DNT>: Your list of monitored entities might show duplicated entities for up to 24 hours.
* <DNT>**Attributes**</DNT>: Poll-based AWS integrations prefix collected resource tags with `label.`, while the AWS CloudWatch Metric Streams integration prefixes collected resource tags with `tags.`. If both integrations are enabled for the same AWS account, resource tags will appear under both prefixes when using the Event format.

