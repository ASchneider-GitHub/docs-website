---
title: Approaches to .NET serverless AWS Lambda performance monitoring
tags:
  - Agents
  - NET agent
  - Getting started
metaDescription: 'This guide helps users decide which approach to take for .NET serverless AWS Lambda performance monitoring.'
freshnessValidatedDate: never
---

Unified visibility into the most detailed behaviors of your .NET Lambda functions is essential so you can understand what's going on in your serverless applications. This information enables you to troubleshoot and optimize your functions so they can work faster and deliver consistent results. 

You can choose from two instrumentation approaches to get visibility into your .NET Lambda functions: 

* [New Relic .NET Agent](/docs/apm/agents/net-agent/getting-started/introduction-new-relic-net/)
* [AWS Distro for OpenTelemetry](https://aws-otel.github.io/docs/getting-started/lambda/lambda-dotnet). 

Use the tips below to help you decide which approach is best for you.

## Feature comparison [#feature-comparison]

The following table outlines the different requirements and capabilities of each approach:

<table>
    <thead>
        <tr>
            <th></th>
            <th>New Relic .NET agent</th>
            <th>AWS Distro for OpenTelemetry</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Requires code changes</td>
            <td>No</td>
            <td>Yes</td>
        </tr>
        <tr>
            <td>Needs tool for sending data</td>
            <td>Yes</td>
            <td>No</td>
        </tr>
        <tr>
            <td>New Relic UI experience</td>
            <td>[Serverless](/docs/serverless-function-monitoring/aws-lambda-monitoring/ui-data/understand-lambda-monitoring-ui/)</td>
            <td>[OpenTelemetry](/docs/opentelemetry/get-started/apm-monitoring/opentelemetry-apm-ui/)</td>
        </tr>
        <tr>
            <td>Distributed tracing</td>
            <td>Yes</td>
            <td>[Partial](/docs/serverless-function-monitoring/aws-lambda-monitoring/opentelemetry/lambda-opentelemetry-dotnet/#distributed-tracing)</td>
        </tr>
        <tr>
            <td>Metrics</td>
            <td>No</td>
            <td>Yes</td>
        </tr>
        <tr>
            <td>Transaction traces</td>
            <td>Yes</td>
            <td>N/A</td>
        </tr>
        <tr>
            <td>Transaction events</td>
            <td>Yes</td>
            <td>[Partial](/docs/opentelemetry/get-started/apm-monitoring/opentelemetry-apm-ui/#transactions-page)</td>
        </tr>
        <tr>
            <td>Error events/spans</td>
            <td>Yes</td>
            <td>Yes</td>
        </tr>
        <tr>
            <td>Span events or spans</td>
            <td>Yes</td>
            <td>Yes</td>
        </tr>
        <tr>
            <td>SQL traces</td>
            <td>Yes</td>
            <td>N/A</td>
        </tr>
        <tr>
            <td>Thread profiling</td>
            <td>No</td>
            <td>N/A</td>
        </tr>
        <tr>
            <td>Vulnerability Management</td>
            <td>No</td>
            <td>N/A</td>
        </tr>
        <tr>
            <td>External calls</td>
            <td>Yes</td>
            <td>[Partial](/docs/opentelemetry/get-started/apm-monitoring/opentelemetry-apm-ui/#externals-page)</td>
        </tr>
        <tr>
            <td>Custom instrumentation using XML</td>
            <td>Yes, using your own custom layer</td>
            <td>No</td>
        </tr>
        <tr>
            <td>Custom instrumentation using API</td>
            <td>Yes (Agent)</td>
            <td>Yes (OpenTelemetry)</td>
        </tr>
        <tr>
            <td>Custom metrics</td>
            <td>No</td>
            <td>Yes</td>
        </tr>
        <tr>
            <td>Custom events</td>
            <td>Yes</td>
            <td>N/A</td>
        </tr>
        <tr>
            <td>Custom spans</td>
            <td>Yes</td>
            <td>Yes</td>
        </tr>
        <tr>
            <td>Custom errors</td>
            <td>Yes</td>
            <td>No</td>
        </tr>
        <tr>
            <td>Custom attributes</td>
            <td>Yes</td>
            <td>Yes</td>
        </tr>
        <tr>
            <td>Logs</td>
            <td>Yes*</td>
            <td>Yes</td>
        </tr>
        <tr>
            <td>Legacy Cross application tracing</td>
            <td>No</td>
            <td>No</td>
        </tr>
    </tbody>
</table>

^*^ Logs-in-context will be captured by the Lambda extension or CloudWatch, not by in-agent log forwarding.

## New Relic .NET agent [#dot-net-agent]
Starting in agent version 10.26.0, the New Relic .NET agent supports instrumenting AWS Lambda functions. In most cases, the .NET agent will automatically instrument your AWS Lambda function. The benefit of using the agent is that in most cases, no code changes are required to monitor your lambda function. 

In a Lambda function, the agent will switch into a "serverless mode" that will disable sending data directly to New Relic, as well as disable some other features. To send data to New Relic, you must either use the New Relic Lambda Extension (included in our .NET agent layer) or CloudWatch. 

Installation methods using the agent layer:

* newrelic-lambda CLI
* CloudFormation/SAM templates
* Serverless Framework plugin
* Terraform
* Manual configuration using AWS UI

In addition to the layer, the agent can also be used via NuGet for an end-to-end manual setup.

### Lambda layer
To simplify the setup process and reduce the number of layers, the .NET agent layer contains a copy of the New Relic .NET agent and a copy of the New Relic Lambda Extension.  The .NET agent layer is available for amd64 and arm64 architectures and supports .NET 6 and .NET 8.  We recommend using the newrelic-lambda CLI to automatically select the appropriate layer for your region and runtime.

#### newrelic-lambda CLI
The newrelic-lambda CLI provides a rapid way to initiate New Relic instrumentation and can be easily integrated into your CI/CD pipeline. Using the newrelic-lambda CLI, you can automatically setup the newest available layer for your Lambda's region and runtime.  It is also possible to have the newrelic-lambda CLI operate on many lambda functions at once.

Since it modifies existing Lambda function resources, redeployment of updated code may inadvertently remove the instrumentation. To ensure continuous monitoring, either re-run the command after each deployment or, preferably, incorporate the New Relic layer and configuration directly into your deployment process.

For installation details, see the "New Relic CLI" section of [Instrument your non-containerized Lambda function](/docs/serverless-function-monitoring/aws-lambda-monitoring/instrument-lambda-function/instrument-your-own/#cli).

#### CloudFormation/SAM templates
AWS's Serverless Application Model, or SAM is a variant of CloudFormation templates that simplifies relating functions to the resources they depend on, and managing the lifecycle of an entire application. We use SAM and CloudFormation for most of [our Lambda example functions](https://github.com/newrelic/newrelic-lambda-extension/tree/main/examples/sam/dotnet), and many other tools are built on top of CloudFormation templates, providing an addition layer of abstraction.

CloudFormation is an AWS service that simplifies the provisioning and management of AWS resources. By defining the desired state of resources in YAML or JSON templates, CloudFormation automatically handles the underlying API calls to create, update, or delete resources as needed. This declarative approach automates infrastructure management, ensuring consistency and reproducibility.

For installation details, see the "CloudFormation" section of [Instrument your non-containerized Lambda function](/docs/serverless-function-monitoring/aws-lambda-monitoring/instrument-lambda-function/instrument-your-own/#cloudformation).

#### Serverless Framework plugin
[Serverless Framework](https://www.serverless.com/framework/docs) is a popular development and deployment tool for serverless applications. It's written for AWS in Node.js, and acts mostly as a high level abstraction on top of CloudFormation templates. It works well for Node, Python, Ruby, Java, and .NET functions.  New Relic offers a [Serverless Framework Plugin](https://github.com/newrelic/serverless-newrelic-lambda-layers) to simplify instrumentation of your Serverless Framework application.

<Callout variant="important">
    Support for .NET Lambda functions begins in v5.3.0 of the serverless plugin.  If you are running a version of the serverless plugin prior to v5.3.0, upgrading to v5.3.0 or later will automatically instrument your .NET Lambda functions.  You can [use the exclude statement](https://github.com/newrelic/serverless-newrelic-lambda-layers?tab=readme-ov-file#exclude-optional) in your serverless.yml to exclude functions from automatic instrumentation.
</Callout>

For installation details, see the "Serverless Framework" section of [Instrument your non-containerized Lambda function](/docs/serverless-function-monitoring/aws-lambda-monitoring/instrument-lambda-function/instrument-your-own/#serverless).

#### Terraform
Terraform is a popular general-purpose infrastructure as code tool. It can be used to manage AWS resources. We offer [some examples](https://github.com/newrelic/newrelic-lambda-extension/tree/main/examples/terraform) of New Relic instrumented Lambda functions deployed using Terraform scripts.

For installation details, see the "Terraform" section of [Instrument your non-containerized Lambda function](/docs/serverless-function-monitoring/aws-lambda-monitoring/instrument-lambda-function/instrument-your-own/#terraform).

#### Manual configuration using AWS UI
While it is more error prone and labor intensive than the approaches above, you can manually alter the configuration of a Lambda function to use New Relic from the AWS Lambda Console, for .NET, Node.js, Python, Ruby and Java.

For installation details, see the "AWS manual instrumentation" section of [Instrument your non-containerized Lambda function](/docs/serverless-function-monitoring/aws-lambda-monitoring/instrument-lambda-function/instrument-your-own/#console).

### NuGet manual setup
Since the agent automatically instruments most lambda functions, it is possible to use the [agent Nuget package](https://www.nuget.org/packages/NewRelic.Agent#readme-body-tab) to monitor your lambda functions.  The environment variables will need to be manually configured for your chosen deployment method and this still requires setting up either the New Relic Lambda Extension or CloudWatch integration in order for data to be sent to New Relic.

You can find more information on the required settings in [our installation guide](/install/dotnet/?deployment=nuget#nuget-linux).

## AWS Distro for OpenTelemetry (ADOT) Lambda Support For .NET
The OpenTelemetry Lambda instrumentation for .NET provides extension and tracing APIs you can use to instrument your Lambda function.  ADOT is available as a layer to make it easier to install. The ADOT Lambda layer provides a reduced version of the AWS Distro for OpenTelemetry Collector, which can export OpenTelemetry data to New  Relic.  Instead of the Serverless UI experience, this approach will use the OpenTelemetry UI.

 This method requires some initial manual configuration depending on your deployment method.

For installation details, see [Trace your .NET Lambda functions with New Relic and OpenTelemetry](/docs/serverless-function-monitoring/aws-lambda-monitoring/opentelemetry/lambda-opentelemetry-dotnet/).
