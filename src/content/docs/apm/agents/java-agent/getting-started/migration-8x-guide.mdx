---
title: Java agent 7.x to 8.x migration guide
tags:
  - Agents
  - Java agent
  - Getting started
redirects:
  - /docs/agents/java-agent/getting-started/migration-8x-guide
freshnessValidatedDate: never
---

# Summary [#summary]

This guide covers the major changes between the 7.x and 8.x series of the Java agent, issues that may be encountered while upgrading, and how to migrate successfully to version 8.x.

The main changes include:

- [Changed and Removed Transaction and Span Attributes](#changed_and_removed_attributes)
- [Removed Instrumentation](#removed_instrumentation)


<Callout variant="important">
In version 8.8.0 the attributes removed in 8.x - 8.7x were reintroduced for backward compatibility for customers that still have alerts or dashboards using the removed attributes.
</Callout>

## Changed and Removed Transaction and Span Attributes [#changed_and_removed_attributes]

To provide consistency across our APM agents and better align with industry standards, we changed transaction and span attributes in the Java agent.

Starting in Java agent version 7.6.0, we introduced the new standard attributes **http.statusCode** and **http.statusText** and marked **httpResponseCode** , **response.status** , and **response.statusMessage** as deprecated.

|Deprecated Attribute |New Attribute |Data Type Change |
| --- | --- | --- |
| **httpResponseCode** | **http.statusCode** | **String to INT** |
| **response.status** | **http.statusCode** | **String to INT** |
| **response.statusMessage** | **http.statusText** | **N/A** |

## Recommended Actions

If you have alerts or dashboards using the deprecated attributes and are using agent version 8.0 - 8.7 you should either update your agent to 8.8 or update references to the removed attributes.

If you have updated all alerts or dashboards to the new standard attributes you can disable the compatibility flag to only use the new standard attributes. To learn about the compatability flag setting see the `http_attribute_mode` configuration

Update alerts and dashboards that are using deprecated attributes.

### Finding Impacted Alert Queries

To find and fix impacted alerts, use the following steps:

1. Use the [NerdGraph Explorer](https://one.newrelic.com/nerdgraph-graphiql) and search alerts using the queryLike operator for each attribute you are looking for. For example:

```
{
  actor {
    user {
      name
    }
    account(id: <ACCOUNTID>) {
      alerts {
        nrqlConditionsSearch(searchCriteria: {queryLike: "httpResponseCode"}) {
          nrqlConditions {
            nrql {
              query
            }
            id
            name
            policyId
          }
        }
      }
    }
  }
}  
```

2. For each alert returned you can use the id or name in the Alerts & AI \> [Alerts Conditions](https://one.newrelic.com/alerts-ai/condition-builder/condition-list) UI to find the alert.
3. Review the alert condition and Signal coverage to confirm the alert is impacted.
4. Use the instructions in [Fixing Impacted Alerts and Dashboards NRQL Statements](#fixing_nrql) to update the NRQL statements.

### Finding Impacted Dashboard Queries

To find the impacted queries for a dashboard, you can use the following steps:

1. Using the NerdGraph Explorer and the entity guid located in the metadata of a dashboard, you can get all the NRQL queries for a dashboard.

```
 {
  actor {
    entity(guid: "[ENTITY GUID]") {
      ... on DashboardEntity {
        guid
        name
        pages {
          widgets {
            rawConfiguration
          }
        }
      }
    }
  }
}
```

2. The NRQL queries will be returned in the rawConfiguration item and you can use the text search to find removed attributes.
3. Use the instructions in [Fixing Impacted Alerts and Dashboards NRQL Statements](#fixing_nrql) to update the NRQL statements.

You can also get the list of entity guids for all dashboard with the following query:

```
 {
  actor {
    entitySearch(query: "domain IN ('VIZ')") {
      results {
        entities {
          guid
          accountId
        }
      }
    }
  }
}
```

### Fixing Impacted Alerts and Dashboards NRQL Statements [#fixing_nrql]

References to either **httpResponseCode** or **response.status** would be replaced by **http.statusCode** , which also has a different data type. Whereas previously you would have used a reference like

[...] WHERE (Numeric(response.status)\>399 [...]

to convert the string datatype to a number, you no longer need to do this and can instead use simple numeric operations such as

[...] WHERE (http.statusCode \>399) [...]

References to **response.statusMessage** would be simply replaced by **http.statusText**. There is no change in data type for this attribute.

## Removed Instrumentation [#removed_instrumentation]

The following instrumentation models were removed for library versions no longer supported by their respective maintainers:

- cassandra-datastax-2.1.2
- httpclient-3.0
- jdbc-embedded-derby-10.2.1.6
- jdbc-embedded-derby-10.10.1.1
- jetty-7
- jetty-7.6
- jetty-9
- jetty-9.0.4
- jetty-9.1
- mongodb-2.12
- mongodb-2.14
- mongodb-3.0
- khttp-3.0.0
- khttp-3.4.0
- khttp-3.5.0

If your application uses one of the libraries, on updating to a Java agent version v8.x, you will no longer receive the metrics and transactions produced by the instrumentation for that library.

## Recommended Actions

If possible, update the impacted library to a version supported by the maintainer and New Relic and update your agent.

If updating the EOLed library is not an option, you can still update your agent, but it is recommended to test and review to determine if the removed data causes any gaps in critical areas.


