---
title: Install the Python agent on Microsoft Azure Container Apps and App Service
metaDescription: How to install APM for Python on Microsoft Azure App Services and Container Apps.
redirects:
  - /docs/agents/python-agent/hosting-services/python-agent-microsoft-azure
  - /docs/python/python-agent-on-microsoft-azure
freshnessValidatedDate: never
---

Microsoft Azure offers two platform services that manage your web or containerized apps. Microsoft Azure App Service and Azure Container Apps are managed platforms that let Azure manage your resource and infrastructure costs to improve the performance of your web or containerized apps. 

This doc walks you through installing the Python agent on both platforms, so you can keep track of resource consumption, app performance, and HTTP traffic in your web or containerized environments. 

## What you need [#compatibility]

In addition to the [Compatibility and requirements for the Python agent](/docs/agents/python-agent/getting-started/compatibility-requirements-python-agent), you'll also need the following for this tutorial:

* A working installation of Python
* The Windows Azure SDK for Python for your platform

<Callout variant="important">
  The Python agent cannot capture telemetry for Azure Functions. Instead, you will need to use the [Azure Functions monitoring integration](/docs/infrastructure/microsoft-azure-integrations/azure-integrations-list/azure-functions-monitoring-integration/).
</Callout>

## Installing the Python agent [#install-python]

To add the New Relic Python agent to your Azure application, add `newrelic` to your `requirements.txt` file.

Here's an example with a sample app:

```python
# app.py
# Run with command "flask run"

from flask import Flask

app = Flask(__name__)

@app.route('/')
def hello_world():
    return "Hello, fellow humans!"

if __name__ == '__main__':
    app.run()
```

On the command line:

```console
foo@bar:~$ cat requirements.txt 
newrelic
flask
```

If you're using a Dockerfile, add `newrelic-admin run-program` as an entrypoint to your startup script.

```lang-dockerfile
COPY requirements.txt .
COPY app.py .

RUN pip install -r requirements.txt

EXPOSE 5000

ENTRYPOINT ["newrelic-admin", "run-program"]
CMD ["flask", "run"]
```

Otherwise, initialize the agent by adding these lines to your app:

```python
# app.py
# Run with command "flask run"

import newrelic.agent   # ADDED
from flask import Flask

newrelic.agent.initialize()   # ADDED

app = Flask(__name__)

@app.route('/')
def hello_world():
    return "Hello, fellow humans!"

if __name__ == '__main__':
    app.run()
```

## Adding app settings in Azure [#azure_settings]

After installation, you must configure your app. 

### Azure App Services [#app-service-configuration-portal]

1. Sign in to <DNT>**[portal.azure.com](https://portal.azure.com)**</DNT>.
2. Select <DNT>**App Services > (select a Python app) > Settings > Environment variables**</DNT>.
3. Add the following to the <DNT>**App settings**</DNT>:

   * `NEW_RELIC_APP_NAME`: Your Linux Azure website name
   * `NEW_RELIC_LICENSE_KEY`: Your New Relic <InlinePopover type="licenseKey" />
4. Save your settings.
5. Restart your Python app.

### Azure Container Apps [#container-app-configuration-portal]

1. Sign in to <DNT>**[portal.azure.com](https://portal.azure.com)**</DNT>.
2. Select <DNT>**Container Apps > (select a Python app) > Containers > Environment variables**</DNT>.
3. Add the following to the <DNT>**Container settings**</DNT>:

   * `NEW_RELIC_APP_NAME`: Your Linux Azure website name
   * `NEW_RELIC_LICENSE_KEY`: Your New Relic <InlinePopover type="licenseKey" />
4. Save your settings.
5. Restart your Python app.

Generate some traffic to your app and wait a few minutes. You can see your data by going to <DNT>**[one.newrelic.com > All capabilities](https://one.newrelic.com/all-capabilities) > APM & services > (select your app)**</DNT>.

## Optional: Adding app settings with the CLI [#app_settings]

Here is an example of how to add the app settings by using the CLI (Python SDK):

### Azure App Services [#app-services-configuration-cli]

Run the following on the command line: 

```bash
az webapp config appsettings set --name ${WEB_APP_NAME} --settings NEW_RELIC_LICENSE_KEY=${NEW_RELIC_LICENSE_KEY} NEW_RELIC_APP_NAME=${NEW_RELIC_APP_NAME}
```

### Azure Container Apps [#container-app-configuration-cli]

Run the following on the command line:

```bash
az containerapp update --name ${CONTAINER_APP_NAME} --set-env-vars "NEW_RELIC_APP_NAME=${NEW_RELIC_APP_NAME}" "NEW_RELIC_LICENSE_KEY=${NEW_RELIC_LICENSE_KEY}"
```

<Callout variant="tip">
  If multiple replicas are allowed, the command above will create a new one.  Otherwise, the container replica will need to be restarted. To do so, find the name of the replica and use that to restart:
  
  ```bash
  az containerapp revision list --name ${CONTAINER_APP_NAME} -o table
  az containerapp revision restart --revision [Revision name from list generated above]
  ```
</Callout>

