---
title: Query time parsing in logs
tags:
  - Logs
  - Log management
  - UI and data
metaDescription: How New Relic uses parsing and how to send customized log data.
freshnessValidatedDate: 2024-05-15 
---



Query time parsing lets you parse your logs directly in the UI without needing to write complex regular expressions or grok patterns. Results are shown instantly since parsing is performed at query time. You can use query time parsing to temporarily extract values from your logs and quickly perform a query on these variables.

## How query time parsing differs from ingest parsing [#differences]

While both types of parsing make it easier for you to query logs, they have some significant differences:

**Ingest parsing:** Parsing during [log ingestion](/docs/logs/ui-data/parsing/) is where you create parsing rules using grok and/or regex. As log records are ingested at New Relic, your parsing rules are applied to create permanent attributes that are stored with your log data in NRDB. These attributes make it easier for you to query log data. 

**Query time parsing:** In contrast to ingest parsing, query time parsing lets you create temporary attributes that will be used as query variables. You can then use these variables in NRQL queries to populate your log table. We automatically create the queries as you make selections in the UI. Your query time parsing rules only alter how your logs appear in the UI and don't change how your logs are stored in our database (NRDB). 

The value of using ingest parsing rules is that you may want to permanently store log attributes so you can query on them later. The benefit of query time parsing in logs is that it's an easy way to make some temporary rules to query your logs without regular expressions or grok patterns. You may choose to use a combination of both parsing approaches.

To summarize the two parsing approaches:

<table>
    <thead>
        <tr>
            <th>
                INSERT_HEADER_CONTENT
            </th>
            <th>
                INSERT_HEADER_CONTENT
            </th>
            <th>
                INSERT_HEADER_CONTENT
            </th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>
                INSERT_CELL_CONTENT
            </td>
            <td>
                Ingest parsing
            </td>
            <td>
                Query time parsing
            </td>
        </tr>
        <tr>
            <td>
                Recommended usage
            </td>
            <td>
                Best for creating permanent attributes you can query in the future
            </td>
            <td>
                Best for doing quick queries on attributes that aren't permanent 
            </td>
        </tr>
        <tr>
            <td>
                Parsing language                
            </td>
            <td>
                You create grok patterns and regular expressions 
            </td>
            <td>
                New Relic creates queries for you using the NRQL [aparse](/docs/nrql/nrql-syntax-clauses-functions/#func-aparse) function 
            </td>
        </tr>
        <tr>
            <td>
                Timing
            </td>
            <td>
                Applied at ingest
            </td>
            <td>
                Applied when you query
            </td>
        </tr>
        <tr>
            <td>
                Results
            </td>
            <td>
                Makes permanent changes to stored log 
            </td>
            <td>
                Temporarily alters the logs table in the UI
            </td>
        </tr>
        <tr>
            <td>
                Live tail logs
            </td>
            <td>
                Live tail logs include any extracted values from ingest parsing
            </td>
            <td>
                Live tail logs **don't** include any extracted values from query time parsing
            </td>
        </tr>
        <tr>
            <td>
                Exported logs
            </td>
            <td>
                Exported logs include any extracted values from ingest parsing
            </td>
            <td>
                Exported logs **don't** include any extracted values from query time parsing
            </td>
        <tr>
            <td>
                Number of attributes
            </td>
            <td>
                A maximum of [255 attributes](/docs/logs/log-api/log-event-data/#events) is available at ingest (the actual number attributes you can parse at ingest depends on the nature of your logs)
            </td>
            <td>
                You can parse a maximum of 32 temporary attributes across all rules for query time parsing
            </td>
        </tr>
        </tr>
    </tbody>
</table>

## How to create a query time parsing rule [#how-to] 

Here's an overview of the tasks for creating query time parsing rules:

<Steps>
  <Step>
    #### Select attribute value to parse [#select-attribute]
    You can start creating a query time parsing rule by selecting an attribute to parse:

        1. In the log table or  in the Formatted tab of the log details view, highlight an attribute value youâ€™d like to parse, known as the anchor string. Keep the following in mind:
            * Your highlighted text should include the value(s) you want to extract and the surrounding string characters that will help identify the location of the extracted value(s). 
            * If your initial anchor string is anywhere in the middle of the original attribute value, include at least one character before and after the values you want to extract.
            * If you're highlighting the entire attribute value, you don't need to worry about characters before and after the values you're extracting.
        2. Click the Create query time parsing rule option when it appears. 
            <Callout variant="tip">
              You cannot highlight blob values to parse.
            </Callout>

            Log table:
            [INSERT IMAGE]

            Log details view:
            [INSERT IMAGE]
  </Step>
  </Step>
    #### Highlight and extract values [#highlight-extractl]

    After you've clicked Create query time parsing rule, the editor displays the string you selected for parsing:

    [INSERT_IMAGE] 

    To extract values:

    * Within the string, highlight the value(s) you want to extract.
    * Under **Parse as**, enter a name for this temporary attribute that will be used as a query variable. 
    * Click **Save**, which replaces the value you highlighted with the variable you created.

<CollapserGroup>
    <Collapser
        id="extract-tips"
        title="Tips for extracting values"
    >
      Keep the following in mind when you extract values:
      * You can extract more than one value in a rule.
      * You **can't** extract values that are directly next to each other. There should be at least one character (including space) between extracted values.
      * If the anchor string **starts** anywhere in the middle of the original attribute value, you **can't** extract the first character.
          * Using the example `level=info msg="Running script"`, you can't extract the full word `level`--only `evel`. 
          * To extract the word `level`, the character(s) before the word `level` would need to be included in the anchor string.
      * If the anchor string **ends** anywhere in the middle of the original attribute value, you cannot extract the last character.
          * Using the example `level=info msg="Running script"`, you can't extract the final double quotation mark. 
          * To extract the last double quotation mark, the character(s) after the double quotation mark would need to be included in the anchor string.
      * Be  careful not to use any of these reserved words as a variable name for query time parsing:
          * `appId`
          * `endTimestamp`
          * `eventType`
          * `logs.accountId`
          * `logs.hashId`
          * `messageId`
          * `message_id`
          * `metricName`
          * `metricTimesliceName`
          * `newrelic.timeslice.value`
          * `timestamp`
          * `timestampSeconds`
          * `timestampMillis`
          * `Cannot start with `nr.` or `newrelic`
      * You cannot name an extracted value with the same name of the attribute that is being parsed. For example, if you are creating a query time parsing rule for the message attribute, an extracted value cannot be named message.
          * Extracted value names must be unique across all query time parsing rules.
          * If an extracted value is given the same name as an existing attribute in your logs, the results in the log table for that column will show both data from ingest and data from query time parsing rules. 
    </Collapser>
</CollapserGroup>

  </Step>
  <Step>
    #### Finish creating your query time parsing rule [#finish-rule]

    After you've selected values, complete the following:

    1. In the editor, review the preview of the table showing how your rule will be applied to the log you selected. 

    [INSERT IMAGE]

    2. If you're interested in the NRQL function used in the query to get your logs, click on Query. 

            The pattern string, which is used to find and extract value(s) from the selected attribute, will be updated whenever a value is extracted


    3. If you need to rename any variables before you create your rule, click on the name, provide a new name, and the click **Save**. You can also delete variables by clicking on the variable you wish to delete and clicking **Delete**.
      [INSERT IMAGE]
      You can edit or delete variables by clicking on them.

    4. After you've finished reviewing and editing your variable names, click **Create rule** to finish creating your rule. 

      <Callout variant="tip">
        If you started creating a query time parsing rule from the log details view, you need to close the Log details view to see your results in the log table.
      <Callout>
    [INSERT IMAGE]
       After creating a rule, view your newly extracted values in the log details view.

    [INSERT IMAGE]
       The log table will automatically refresh and apply the generated query to parse your logs

 

  </Step>
  <Step>

  </Step>
  <Step>

  </Step>
</Steps>

