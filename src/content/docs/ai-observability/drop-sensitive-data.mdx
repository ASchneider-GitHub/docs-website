---
title: 'Remove sensitive data with drop filters'
metaDescription: 'Drop filters use regex to filter out personally identifying information before it reaches our databases.'
freshnessValidatedDate: never
---

import apmAimDropFilters from 'images/apm_screenshot-crop_aim-drop-filters.webp'

AI Monitoring captures event data about how your AI assistant responds to prompts. This event data can contain metrics about latency, 

After AI Monitoring captures event data, you can direct the agent to drop that data so it isn't stored in NRDB. Drop filters apply regex to NRQL queries so AI Monitoring can match data to the query, then drop it. This doc walks you through how to set up drop filters. 

<img
    title="Drop filters page"
    alt="A screenshot that shows the drop filter landing page for AIM"
    src={apmAimDropFilters}
/>

<figcaption>
    To find this page, go to **[one.newrelic.com](https://one.newrelic.com) > All capabilities > AI Monitoring > Drop filters**
</figcaption>

## Build your drop filters [#sec-compliance]

An AI assistant's message to an end user can be stored in NRDB under five separate event types:  

<table>

    <tbody>
        <tr>
            <td>
                `LlmChatCompletion`
            </td>
            <td>
                Describe what decisions / point of the toolchain this event captures as it relates to sensitive data
            </td>
        </tr>
        <tr>
            <td>
                `LlmTool`
            </td>
            <td>
                  Describe what decisions / point of the toolchain this event captures as it relates to sensitive data
            </td>
        </tr>
        <tr>
            <td>
                `LlmChain events`
            </td>
            <td>
                  Describe what decisions / point of the toolchain this event captures as it relates to sensitive data
            </td>
        </tr>
        <tr>
            <td>
                `LlmChatCompletionSummary`
            </td>
            <td>
                  Describe what decisions / point of the toolchain this event captures as it relates to sensitive data
            </td>
        </tr>
                <tr>
            <td>
                `LlmChatCompletionMessage`
            </td>
            <td>
                  Describe what decisions / point of the toolchain this event captures as it relates to sensitive data
            </td>
        </tr>
    </tbody>

</table>

When you create a drop filter for one kind of sensitive data, it's critical that you apply the rule to the four other events. This ensures that no artifact of that sensitve data persists in our database. 

## Create drop filters [#create]

Follow these procedures when creating a drop filter. Let's say you want to drop any instance of a customer's personal address whenever it appears in a prompt or response. 

<Steps>
    <Step>

    ## Go to the drop filters page [#filters-page]

        Go to **[one.newrelic.com > All Capabilities > AI Monitoring > Drop filters](https://onenr.io/0PoR8KlvYwG)**, then click **Create drop filter**. 

    </Step>
    <Step>
        
    ## Prepare your NRQL query [#nrql] 


    
    </Step>
    <Step>
        
    ## Add drop filter to four additional tables

          Drop filters use NRQL queries to drop sensitive data. Here are three examples of a NRQL query using regex to locate and drop sensitive data:

        * EXAMPLE
        * EXAMPLE
        * EXAMPLE 

        There's a secion at the end of this procedure with regex samples to get you started with drop filters. 

        New Relic stores its data in five different tables. When you create a drop filter to drop one kind of data (say, a birth date), you need to repeat the process four additional times to account for those five tables. 

    </Step>
    <Step>
        
    ## Test your drop filter

    To test your drop filter, ELEPHANT 

    </Step>
</Steps>

## Sample expressions [#regex-ref]

REGEX INTRO HERE 

<CollapserGroup>
  <Collapser
    id="ssn"
    title="US social security number"
  >
    **Expression:**
    ```
    (\d{3}[-\s\.]?\d{2}[-\s\.]?\d{4})
    ```
  </Collapser>

  <Collapser
    id="ccn"
    title="Credit card number"
  >
    **Expression:**
    ```
    ((?:(?:4\d{3})|(?:5[1-5]\d{2})|6(?:011|5[0-9]{2}))(?:-?|\040?)(?:\d{4}(?:-?|\040?)){3}|(?:3[4,7]\d{2})(?:-?|\040?)\d{6}(?:-?|\040?)\d{5})
    ```
  </Collapser>

  <Collapser
    id="dob"
    title="US Date of birth"
  >
    **Expression:**
    ```
    ((?:\d{2})?\d\d(?:\\)?(?:\/)?\d\d(?:\\)?(?:\/)?\d{2}(?:\d{2})?)
    ```
  </Collapser>

  <Collapser
    id="email"
    title="Email address"
  >
    **Expression:**
    
    ```
    ([a-zA-Z0-9!#$'*+?^_`{|}~.-]+(?:@|%40)(?:[a-zA-Z0-9-]+\.)+[a-zA-Z0-9-]+)
    ```
  </Collapser>

  <Collapser
    id="ipv4"
    title="IP address (ipv4)"
  >
    **Expression:**
    ```
    ^([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$
    ```
  </Collapser>

  <Collapser
    id="usstreetaddress"
    title="US street address"
  >
    **Expression:**
    ```
    /\d{1,}(\s{1}\w{1,})(\s{1}?\w{1,})/g
    ```
  </Collapser>

  <Collapser
    id="usphone"
    title="US phone number"
  >
    **Expression:**
    ```
    (^[\+]?[1]?[\W]?[(]?[0-9]{3}[)]?[-\s\.]?[0-9]{3}[-\s\.]?[0-9]{4})
    ```
  </Collapser>

  <Collapser
    id="uspassport"
    title="US passport number"
  >
    **Expression:**
    ```
    ([a-zA-Z]?\d?\d{5,8})
    ```
  </Collapser>

  <Collapser
    id="uknino"
    title="UK national insurance number (NINO)"
  >
    **Expression:**
    ```
    ([a-zA-Z]{2}[-\s]?\d{2}[-\s]?\d{2}[-\s]?\d{2}[-\s]?[a-dA-D])
    ```
  </Collapser>

  <Collapser
    id="spainnid"
    title="Spain National ID (NIE/DNI/NIF)"
  >
    **Expression:**
    ```
    ([a-zA-Z]?[-\s]?\d{7,8}[-\s]?[a-zA-Z])
    ```
  </Collapser>

  <Collapser
    id="indiapanid"
    title="India PAN ID"
  >
    **Expression:**
    ```
    ^([a-zA-Z]){5}([0-9]){4}([a-zA-Z]){1}?$
    ```
  </Collapser>

  <Collapser
    id="indiaaadhaar"
    title="India AADHAAR ID"
  >
    **Expression:**
    ```
    ^([2-9]{1}[0-9]{3}\s\d{4}\s\d{4})$
    ```
  </Collapser>

  <Collapser
    id="caphin"
    title="Canada personal health/social insurance number (PHIN/SIN)"
  >
    **Expression:**
    ```
    (\d{3}[-\s\.]?\d{3}[-\s\.]?\d{3})
    ```
  </Collapser>

  <Collapser
    id="cahcn"
    title="Canada health card number"
  >
    **Expression:**
    ```
    (\d{10})
    ```
  </Collapser>

</CollapserGroup>

## What's next? [#whats-next]

jhbhkjhkjhkjh