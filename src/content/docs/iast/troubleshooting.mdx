---
title: IAST Troubleshooting
tags:
    - IAST
    - New Relic IAST
    - Troubleshooting
metaDescription: Find out how to solve your New Relic IAST issues.
---

This is the first step in diagnosing your New Relic IAST problem yourself, use this guide to resolve issues quickly. 

If you continue to have trouble, you can always reach out to [New Relic Support](https://support.newrelic.com) if you don't find your problem here.  

<CollapserGroup>
    <Collapser
    id="security-agent-working"
    title="I'm not sure the security agent is working"
    >
    IAST requires restarting the application after it's enabled.
    
    </Collapser>

    <Collapser
    id="see-vulnerabilities"
    title="I don't see vulnerabilities in IAST"
    >
    If this is a new app, firewalls could be preventing it from communicating with the NR platform. Check the service stats section in the file with the latest timestamp in `nr-security-home/logs/snapshots`. All 6 items in that list should say OK. If they don't, review the logs for additional info or reach out to [New Relic Support](https://support.newrelic.com). You can also see the [standard firewall documentation](/docs/new-relic-solutions/get-started/networks/).

    </Collapser>

    <Collapser
    id="see-my-application"
    title="I don't see my application in IAST"
    >
    If you don't see your application in **[one.newrelic.com](https://one.newrelic.com) > All capabilities > IAST > Applications > Tested applications**, check the following:
    
    - an incorrect version of the APM agent. Check the version of your APM agent and upgrade it if needed.
    - IAST flags are disabled. Check the security configuration, and make sure about enabling IAST flags for your security agent.
    - an unexpected error. To see what went wrong, go to the `nr-security-home/logs` directory and find the `[SETP-8]` line in the `LANGUAGE-security-collector-init.log` file.
    - lack of traffic on the application. Generate some traffic to allow IAST to test your application. 
    
    </Collapser>

    <Collapser
    id="agent-working"
    title="I'm not sure if the security agent works"
    >

    <Callout variant="important">
    If you're using [APM's high security mode](/docs/apm/agents/manage-apm-agents/configuration/high-security-mode/), the agent won't work.

    To disable it, you need to contact [New Relic Support](https://support.newrelic.com/s/).
    </Callout>

    When the security agent is working correctly:

    - You see your application in **[one.newrelic.com](https://one.newrelic.com) > All capabilities > IAST > Applications > Tested applications**.
    - You see coverage for the application in **[one.newrelic.com](https://one.newrelic.com) > All capabilities > IAST > Applications**. Select your application and then, the coverage tab.
    - You see the message `Security Agent is now ACTIVE` in the security agent log file `nr-security-home/logs/LANGUAGE-security-collector.log`. Replace `LANGUAGE` in the filename with the one you used.
    - You get the `OK` value for `Service stats -> agentActiveStat` in the latest log file in `nr-security-home/logs/snapshots/`.
    - In the `nr-security-home/logs` directory, search for the `LANGUAGE-security-collector-init.log` file. Replace `LANGUAGE` in the filename with the one you used, and make sure you see these steps:
        - [STEP-1]: The security agent is starting.
        - [STEP-2]: The security agent generates a unique identifier. For web socket connection, you'll see Node auth headers.
        - [STEP-3]: The security agent gathers information about your application.
        - [STEP-4]: The web socket connection to SaaS validator is established successfully.
        - [STEP-5]: The security agent threads are started.
        - [STEP-6]: The application instrumentation is successful.
        - [STEP-7]: The application receives and applies your policies and configuration.
        - [STEP-8]: You see a first event sent for validation, which means the security agent started successfully.

    Here's an excerpt of a security agent log file `LANGUAGE-security-collector-init.log`:

    ```
    Init Log File initiated.
    Init Logger configured successfully with level: INFO and rollover on max size 52428800.
    2023-05-26 10:45:02 :  [8] [New Relic RPM Connection Service] INFO : com.newrelic.api.agent.security.Agent - [STEP-1] => Security agent is starting
    2023-05-26 10:45:02 :  [8] [New Relic RPM Connection Service] INFO : com.newrelic.agent.security.AgentInfo - [STEP-2] => Generating unique identifier: 8a6d79c3-ad67-35d6-b811-17f7515b7f29
    2023-05-26 10:45:02 :  [8] [New Relic RPM Connection Service] INFO : com.newrelic.api.agent.security.Agent - [STEP-3] => Gathering information about the application
    ```
    </Collapser>

    <Collapser
    id="looking-for-vulns"
    title="I'm not sure IAST is looking for vulnerabilities"
    >
    IAST starts testing when detects that there is traffic, so check if your application works out or has any traffic directed at it. Perform the app's UI or API endpoints.

    </Collapser>

    <Collapser
    id="no-vulns"
    title="I don't see vulnerabilities in IAST"
    >
    If you see your application in New Relic and the security agent successfully started IAST, but you don't see vulnerabilities in **[one.newrelic.com](https://one.newrelic.com) > All capabilities > IAST**, then check the following:

    - Go to **[one.newrelic.com](https://one.newrelic.com) > All capabilities > IAST > Applications** and check your application level of efficiency. The **Test efficiency** column indicates if the level of your application is **hight**, **medium**, or **low**.

    - Go to **[one.newrelic.com](https://one.newrelic.com) > All capabilities > IAST > Applications** to check if your application is secure. Your application has the **high** value in the **Test efficiency** column, but it doesn't have detected vulnerabilities. 

    - Open the latest log file in your `nr-security-home/logs/snapshots/` folder, and look for the `Service stats -> websocket` line to check if your web socket connection is broken. The expected value is `OK`.

    - Your application's framework or vulnerability category is not supported. See the supported frameworkd for the security agents:
        - [Java](https://github.com/newrelic/csec-java-agent#support-matrix)
        - [Node.js](https://github.com/newrelic/csec-node-agent/#supported--modules)
        - [Go](https://github.com/newrelic/csec-go-agent/tree/v0.1.0#support-matrix)

    If you're still not sure why you don't see vulnerabilities in IAST, share your application's configuration and logs with [New Relic Support](https://support.newrelic.com).

    </Collapser>

    <Collapser
    id="stability-issues"
    title="I'm facing application stability issues"
    >
    Your application may show high traffic and latency for some time as part of IAST. This should resolve in a few minutes when it finishes the IAST test.

    You can also check the snapshot log file in the `nr-security-home/logs/snapshots` folder. The log file shows you the status of the security agent, resource usage, and the last five errors.   

    </Collapser>

    <Collapser
    id="unknown-files"
    title="I see unknown files and directories in my application directory"
    >
    If your application has the functionality to create files and directories as part of serving an HTTP request, IAST will try to test the code path and hence, create such files and directories. The application code, under the influence of incoming HTTP requests, creates these files. The agent can't deleted them.

    If you're sure that none of your APIs can create files and directories, share your application's configuration and logs with [New Relic Support](https://support.newrelic.com).

    </Collapser>

    <Collapser
    id="not-responding"
    title="My application isn't responding or crashed"
    >
    As a part of IAST, the security agent sends new requests to the application that increases the load, resulting in an increase of resource utilization. This IAST analysis can also expose uncaught errors or exceptions in your application.

    If the application has crashed due to lack of resources, increase the resources, restart the application, and perform IAST again.

    </Collapser>

    <Collapser
    id="golang-vuln"
    title="No vulnerabilities detected for my Golang application"
    >
    For Golang, make sure that you imported the required instrumentation packages for the libraries and frameworks that your application uses.

    For instance, let's suppose that your application is using this library: [https://github.com/robertkrimen/otto](https://github.com/robertkrimen/otto). For this specific library, you need to import this instrumentation package: [https://github.com/newrelic/csec-go-agent/instrumentation/csec_robertkrimen_otto](https://github.com/newrelic/csec-go-agent/instrumentation/csec_robertkrimen_otto).

    </Collapser>
    
    <Collapser
    id="windows-vuln"
    title="I don't see all the expected vulnerabilities for my Windows application"
    >
    Currently, we don't fully support Windows, so some vulnerabilities won't be detected.

    </Collapser>
</CollapserGroup>
