title: Install in GKE Autopilot
tags:
  - Integrations
  - Kubernetes integration
  - Installation
  - Autopilot
metaDescription: How to install the nri-bundle in GKE Autopilot mode. 

## Requirements
1. Use unprivileged mode
  * GKE Autopilot does not allow privileged containers of any kind
2. Turn off controlPlane
  * GKE Autopilot does not provide access to the control plane. 
3. Disable logging
  * The logging integration requires privileged mode which is not allowed in GKE Autopilot.

<Callout variant="important">
  Pixie and logging will not work in unpriviled mode. 
</Callout>

## Installation [#installation]

### Guided Install (recommended)
You will be prompted by the guided install to answer whether you're installing in a GKE Autopilot cluster. Enter `Y` and this will continue the installation. If you enter `N`, the installation will stop and Kubernetes integration won't be installed. 

### Helm command [#helm-command]
* Update or set the following flags in the helm command:
  ```helm
    --set newrelic-infrastructure.privileged=false
    --set newrelic-infrastructure.controlPlane.enabled=false
    --set logging.enabled=false
  ```

  * Example helm command:
    ```helm
    KSM_IMAGE_VERSION="v2.10.0" && \
    helm repo add newrelic https://helm-charts.newrelic.com && helm repo update && \
    kubectl create namespace newrelic ; helm upgrade --install newrelic-bundle newrelic/nri-bundle \
    --set global.licenseKey=<Your License Key> \
    --set global.cluster=<Your Cluster Name> \
    --namespace=newrelic \
    --set newrelic-infrastructure.privileged=false \
    --set newrelic-infrastructure.controlPlane.enabled=false \
    --set global.lowDataMode=true \
    --set kube-state-metrics.image.tag=${KSM_IMAGE_VERSION} \
    --set kube-state-metrics.enabled=true \
    --set kubeEvents.enabled=true \
    --set newrelic-prometheus-agent.enabled=true \
    --set newrelic-prometheus-agent.lowDataMode=true \
    --set newrelic-prometheus-agent.config.kubernetes.integrations_filter.enabled=false \
    --set logging.enabled=false \
    --set newrelic-logging.lowDataMode=true 
    ```

### Manifest command [#manifest-command]
Update the manifest command to turn set privileged, controlPlane and logging to `false`.

  * Example manifest command:
    ```manifest
    KSM_IMAGE_VERSION="v2.10.0" && \
    curl -X POST https://k8s-config-generator.service.newrelic.com/generate -H 'Content-Type: application/json' -d '{"global.cluster":"<Your Cluster Name>","global.namespace":"newrelic","newrelic-infrastructure.privileged":"false","newrelic-infrastructure.controlPlane.enabled":"false","global.lowDataMode":"true","kube-state-metrics.image.tag":"'${KSM_IMAGE_VERSION}'","kube-state-metrics.enabled":"true","kubeEvents.enabled":"true","newrelic-prometheus-agent.enabled":"true","newrelic-prometheus-agent.lowDataMode":"true","newrelic-prometheus-agent.config.kubernetes.integrations_filter.enabled":"false","logging.enabled":"false","newrelic-logging.lowDataMode":"true","global.licenseKey":"<Your License Key"}'  > newrelic.yaml && (kubectl create namespace newrelic ; kubectl apply -f newrelic.yaml)
    ```