---
title: Install the Android agent 
tags:
  - Mobile monitoring
  - New Relic Mobile Android
  - Install configure
translate:
  - jp
  - kr
metaDescription: 'New accounts: Get Android app monitoring in New Relic at newrelic.com/signup. Existing accounts: Add mobile monitoring to your Android apps from the UI.'
redirects:
  - /docs/mobile-apps/troubleshooting-eclipse-configurations
  - /docs/mobile-monitoring-installation/troubleshooting-eclipse-configurations
  - /docs/mobile-apps/maven-installation
  - /docs/mobile-monitoring-installation/maven-installation
  - /docs/mobile-apps/gradle-installation
  - /docs/mobile-monitoring-installation/gradle-installation
  - /docs/mobile-apps/android-installation-and-configuration
  - /docs/mobile-monitoring-installation/android-installation-and-configuration
  - /docs/mobile-apps/eclipse-installation
  - /docs/mobile-monitoring-installation/eclipse-installation
  - /docs/mobile-monitoring/mobile-monitoring-installation/getting-started/android-installation-and-configuration
  - /docs/mobile-monitoring/mobile-monitoring-installation/android/installing-android-apps-gradle-and
  - /docs/mobile-monitoring/mobile-monitoring-installation/android/troubleshooting-eclipse-configurations
  - /docs/mobile-monitoring/mobile-monitoring-installation/android/installing-android-apps-eclipse
  - /docs/mobile-monitoring/mobile-monitoring-installation/getting-started/android-installation-configuration
  - /docs/mobile-monitoring/mobile-monitoring-installation/android/installing-android-apps-gradle-android-studio
  - /docs/mobile-monitoring/mobile-monitoring-installation/android/installing-android-apps-maven
  - /docs/mobile-monitoring/mobile-monitoring-installation/legacy/installing-android-apps-eclipse
  - /docs/mobile-monitoring/new-relic-mobile-android/install-configure/android-installation-configuration
  - /docs/mobile-monitoring/new-relic-mobile-android/install-configure/installing-android-apps-gradle-android-studio
  - /docs/mobile-monitoring/new-relic-mobile-android/get-started/android-installation-configuration
  - /docs/mobile-monitoring/new-relic-mobile-android/legacy/installing-android-apps-eclipse
  - /docs/mobile-monitoring/new-relic-mobile-android/install-configure/installing-android-apps-maven
  - /docs/mobile-monitoring/new-relic-mobile-android/install-configure
  - /docs/mobile-monitoring/new-relic-mobile-android/install-configure/configure-android-gradle-android-studio
---

You can install the mobile agent for Android monitoring with our [guided install](https://onenr.io/0kjnEoryzRo), or you can install manually. The guided install is a good option for simple app environments. For other cases, you can follow the steps below to install the Android agent.

## Install the Android agent [#installation]

As part of the installation process for mobile monitoring, New Relic automatically generates an [application token](/docs/mobile-apps/viewing-your-application-token). This is a 40-character hexadecimal string for authenticating each mobile app you monitor in New Relic.

<Steps>
    <Step>
        ### Add your Android app to New Relic

1. Go to **[one.newrelic.com > All capabilities](https://one.newrelic.com/all-capabilities) > Mobile**.
2. From the [**Mobile apps** index](/docs/mobile-monitoring/mobile-monitoring-ui/mobile-app-pages/mobile-apps-index), select **Add a new app**.
3. From the **Get started** page, select **Android** as your mobile monitoring platform.
4. Enter a name for your mobile app, then select **Continue**.

    </Step>
    <Step>
        ### Update your Gradle build behavior through either the project or app build files

This configuration sets the project token, enables or disables features, and setting thresholds for alerts. You can configure one or both depending on your monitoring needs:

* To capture data across all apps in a project, configure on the project level. 
* To capture data about one app within your Android project, configure on the app level. For example, let's say you have a build file for testing and a build file for production, but you only want to monitor your production build. Configure only the app build file to limit where the Android agent captures data. 
* To set different configurations for different apps within a project, set a default configuration on the project level and app-level configurations on the app level.

Because the Android agent is not yet available as a community plugin, you need to provide the classpath through [MavenCentral](https://mvnrepository.com/artifact/com.newrelic.agent.android/agent-gradle-plugin) so the agent can monitor your Android app. 

<CollapserGroup>
    <Collapser
        id="project-level"
        title="Update the project level build file"
    >

Add the following snippet to the project level build file. This snippet directs the Android agent to capture all data about all apps in a project. 

  ```xml
  buildscript {
    repositories {
      mavenCentral()
    }

    dependencies {
      classpath "com.newrelic.agent.android:agent-gradle-plugin:<a href="/docs/release-notes/mobile-release-notes/android-release-notes">AGENT_VERSION</a>"
    }
  }
  ```    
  </Collapser>
    <Collapser
        id="app-level"
        title="Update the app level build file"
    >

Add the following snippet to the app level build file. This snippet directs the Android agent to capture data about the app this snippet appears in, but not others.  

  ```xml
  repositories {
    mavenCentral()
  }

  apply plugin: 'android'
  apply plugin: 'newrelic'

  dependencies {
    implementation 'com.newrelic.agent.android:android-agent:<a href="/docs/release-notes/mobile-release-notes/android-release-notes">AGENT_VERSION</a>'
  }
  ```
      </Collapser>
</CollapserGroup>

In both scripts, replace `<AGENT_VERSION>` with the most recent agent version. See the [agent release notes](/docs/release-notes/mobile-release-notes/android-release-notes) to stay up to date.  

    </Step>
    <Step>
    ### Instrument the Gradle Plugin Portal

<Callout variant="tip">
If your app isn't using plugins from the Gradle Plugin Portal, then you can skip this step and move onto the next step.
</Callout>

If you use the Gradle Plugin Portal to add community-sourced plugins to your app, you need to make a third configuration.

1. Update your `settings.gradle(.kts)` file, or update your project level build file. You may not have a `settings.gradle(.kts)` file if you don't have subprojects in addition to your root project. In that case, you should update the project file. 
2. Update the app level build file where those plugins are used.  

All plugins use a `{} DSL` method that resolves plugins from the [Gradle Plugin Portal](https://plugins.gradle.org/). This is a default behavior.  

<CollapserGroup>
    <Collapser
        id="kts"
        title="Configure with `settings.gradle(.kts)`"
    >

To initiate the agent plugin in your app, find the [`pluginManagement {}`](https://docs.gradle.org/current/dsl/org.gradle.plugin.management.PluginManagementSpec.html) block in your `settings.gradle(kts)` file. 

In the following example, replace `AGENT_VERSION` with the most recent [agent release version](/docs/release-notes/mobile-release-notes/android-release-notes). 

```
pluginManagement {
  repositories {
    mavenCentral()  // adds repo for NewRelic artifacts
  }
  resolutionStrategy {
    eachPlugin {
      if (requested.id.id.startsWith("newrelic")) {
        useModule("com.newrelic.agent.android:agent-gradle-plugin:${AGENT_VERSION}")
      }
    }
  }

  // optional: define as a community plugin here or in root level build file

  // for core Gradle plugins or plugins already available to the build script
  plugins {
    id("newrelic") version "${<AGENT_VERSION>}"
  }
}
```
    </Collapser>
    <Collapser
        id="project"
        title="Configure in the project level build file"
    >

You can also update your build file on the project-level:

```
plugins {
  // for binary Gradle plugins that need to be resolved
  id("newrelic") version "<AGENT_VERSION>" apply false
}     
```    

  </Collapser>
</CollapserGroup>
  
Next, you need to apply the required plugins to the `plugins{}` block in your app module. 

```
plugins {
    id("com.android.application")
    id("org.jetbrains.kotlin.android")
    id("newrelic")
}
```

    </Step>
    <Step>
        ### Set app permissions 

Once you've applied the plugins, you need to set your system permissions so your app can make requests to `INTERNET` and `ACCESS_NETWORK_STATE`. Add this code snippet to your `AndroidManifest.xml` file:

  ```xml
    <uses-permission android:name="android.permission.INTERNET" />
    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
  ```
        
    </Step>
    <Step>
        ### Ensure the Android agent runs when your app runs

From your app's manifest, find the activity subelement. You need to import the `NewRelic` class in your `onCreate()` method. This initializes mobile monitoring when your app starts up: 

```xml
import com.newrelic.agent.android.NewRelic;
```

    </Step>
    <Step>
    ### See your data in New Relic

7. To build and run your application: Clean your project, then run your app in an emulator or device to generate traffic.
8. Wait a few minutes, then view data for your Android app from the [**Summary** page](/docs/mobile-monitoring/mobile-monitoring-ui/mobile-app-pages/mobile-apps-overview-page): Go to **[one.newrelic.com > All capabilities](https://one.newrelic.com/all-capabilities) > Mobile > (select an app)**.

[troubleshooting procedures](/docs/mobile-monitoring/new-relic-mobile-android/troubleshoot/no-data-appears-android)

    </Step>
</Steps>

For details on how to configure the behavior of the mobile monitoring agent plugin during Gradle builds, see the [New Relic Gradle plugin](/docs/mobile-monitoring/new-relic-mobile-android/install-configure/configure-new-relic-gradle-plugin) extension guide.

## Android 4.x: Multidex support [#4x-multidex]

New Relic's mobile monitoring for Android versions prior to Android 5.0 (API level 21) use the Dalvik runtime to execute app code. By default, Dalvik limits apps to a single `classes.dex` bytecode file per APK. In order to get around this limitation, you **must** [enable multidex support](https://developer.android.com/studio/build/multidex.html). Then you can use the [multidex support library](https://developer.android.com/tools/support-library/features.html#multidex), which becomes part of the primary DEX file of your app and then manages access to the additional DEX files and the code they contain.

When building each DEX file for a multidex app, the build tools perform complex decision making to determine which classes are needed in the primary DEX file so that your app can start successfully. If any class required during startup is not provided in the primary DEX file, then your app crashes with the error `java.lang.NoClassDefFoundError`.

If you see the `java.lang.NoClassDefFoundError` error, then you must [manually specify these additional classes as required](https://developer.android.com/studio/build/multidex.html#keep) in the primary DEX file:

1. Create a `proguard.multidex.config` file within the `/app` folder of your project. Update `mypackage` to reflect your package name.

```
####################
# keep class names #
####################

#Keep New Relic in the main dex
-keep class com.newrelic.** { *; }
-keep class com.mypackage.activities.** { *; }
```

2. Merge the following code into the app-level `build.gradle` file:

```
android {
    defaultConfig{
        …
        multiDexKeepProguard file("proguard.multidex.config")
    }
}
```

For more information, see the [Android Developers documentation](https://developer.android.com/studio/build/multidex.html#keep) on declaring classes required in the primary DEX file.

## What's next? 

Congratulations! You've successfully installed the mobile monitoring agent to your Android app. You have a few options for next steps:

* Set up ProGuard or DexGuard BANANA with our [Configure ProGuard or DexGuard for Android apps](/docs/mobile-monitoring/new-relic-mobile-android/install-configure/configure-proguard-or-dexguard-android-apps) doc.
* [Enable logs](/docs/mobile-monitoring/new-relic-mobile/mobile-sdk/configure-settings/#logging), which includes choosing when the agent forwards Android logs to New Relic.
* [Upgrade the Android agent SDK](/docs/mobile-monitoring/new-relic-mobile-android/install-configure/upgrading-new-relic-mobiles-android-sdk) to keep your Android agent up to date. 
* Having problems with your Android installation? Follow the [troubleshooting procedures](/docs/mobile-monitoring/new-relic-mobile-android/troubleshoot/no-data-appears-android).