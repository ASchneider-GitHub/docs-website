---
title: Install the Android agent 
tags:
  - Mobile monitoring
  - New Relic Mobile Android
  - Install configure
translate:
  - jp
  - kr
freshnessValidatedDate: 2024-11-30
metaDescription: 'New accounts: Get Android app monitoring in New Relic at newrelic.com/signup. Existing accounts: Add mobile monitoring to your Android apps from the UI.'
redirects:
  - /docs/mobile-apps/troubleshooting-eclipse-configurations
  - /docs/mobile-monitoring-installation/troubleshooting-eclipse-configurations
  - /docs/mobile-apps/maven-installation
  - /docs/mobile-monitoring-installation/maven-installation
  - /docs/mobile-apps/gradle-installation
  - /docs/mobile-monitoring-installation/gradle-installation
  - /docs/mobile-apps/android-installation-and-configuration
  - /docs/mobile-monitoring-installation/android-installation-and-configuration
  - /docs/mobile-apps/eclipse-installation
  - /docs/mobile-monitoring-installation/eclipse-installation
  - /docs/mobile-monitoring/mobile-monitoring-installation/getting-started/android-installation-and-configuration
  - /docs/mobile-monitoring/mobile-monitoring-installation/android/installing-android-apps-gradle-and
  - /docs/mobile-monitoring/mobile-monitoring-installation/android/troubleshooting-eclipse-configurations
  - /docs/mobile-monitoring/mobile-monitoring-installation/android/installing-android-apps-eclipse
  - /docs/mobile-monitoring/mobile-monitoring-installation/getting-started/android-installation-configuration
  - /docs/mobile-monitoring/mobile-monitoring-installation/android/installing-android-apps-gradle-android-studio
  - /docs/mobile-monitoring/mobile-monitoring-installation/android/installing-android-apps-maven
  - /docs/mobile-monitoring/mobile-monitoring-installation/legacy/installing-android-apps-eclipse
  - /docs/mobile-monitoring/new-relic-mobile-android/install-configure/android-installation-configuration
  - /docs/mobile-monitoring/new-relic-mobile-android/install-configure/installing-android-apps-gradle-android-studio
  - /docs/mobile-monitoring/new-relic-mobile-android/get-started/android-installation-configuration
  - /docs/mobile-monitoring/new-relic-mobile-android/legacy/installing-android-apps-eclipse
  - /docs/mobile-monitoring/new-relic-mobile-android/install-configure/installing-android-apps-maven
  - /docs/mobile-monitoring/new-relic-mobile-android/install-configure
  - /docs/mobile-monitoring/new-relic-mobile-android/install-configure/configure-android-gradle-android-studio
  - /docs/mobile-monitoring/new-relic-mobile-android/install-configure/install-android-apps-gradle-android-studio
---

To install the Android agent, you need to use our [guided install](https://onenr.io/0kjnEoryzRo). Setting up the Android agent requires an [application token](/docs/mobile-apps/viewing-your-application-token) that authenticates each mobile app you want to monitor. The app token is only available by going through the guided install.

## Install the Android agent with guided install [#guided-install]

1. Go to <DNT>**[one.newrelic.com](https://one.newrelic.com) > Integrations & Agents > Mobile > Android**</DNT>.
2. Follow the guided install steps to set up your Android agent.
3. Wait a few minutes, then view your data by going to <DNT>**[one.newrelic.com > All capabilities](https://one.newrelic.com/all-capabilities) > Mobile > (select your app)**</DNT>.

## Manually install the Android agent [#manual-install]

These procedures appear in our guided install. Keep in mind that even if you're updating your build files through the docs, you still need to add your app to New Relic and grab your generated app token from the guided install. You cannot capture data about your Android apps otherwise.


## Resolve and apply the New Relic Android Agent Gradle plugin
```In this example, `AGENT_VERSION` represents your agent version number. See the [agent release notes](/docs/release-notes/mobile-release-notes/android-release-notes), and use the latest version.```

Starting with version 7.6.0, the New relic Android Gradle plugin is available on the [Gradle Plugin Portal](). This greatly simplifies the resolution and loading of community plugins.

Newer apps should follow the instructions to [Apply the plugin using the plugins DSL block]](#plugin-dsl) to use agent plugin hosted on [Gradle Plugin Portal](https://plugins.gradle.org/). 

If adding the New Relic Android agent to an older app, follow the instructions to [apply the plugin using the buildscript](#buildscript)

Gradle [guidance](https://docs.gradle.org/current/userguide/plugins.html#sec:binary_plugin_locations) on the various approaches to resolving plugins.


2. Set app permissions. Ensure that your Android app requests `INTERNET` and `ACCESS_NETWORK_STATE` permissions by adding these lines to your `AndroidManifest.xml` file:

   ```xml
   <uses-permission android:name="android.permission.INTERNET" />
   <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
   ```

3. Start the Android agent. In your default Activity found in your manifest, import the `NewRelic` class:

   ```java
   import com.newrelic.agent.android.NewRelic;
   ```

   We don't support starting the <InlinePopover type="mobile"/> agent in other classes, as that can cause unexpected or unstable behavior.

4. After you've imported the `NewRelic` class, you need to add an additional snippet to the `onCreate()` method, which includes your app token, which is generated in the guided install. The snippet looks like this:

   ```java
   NewRelic.withApplicationToken("GENERATED_TOKEN").start(this.getApplicationContext());
   ```

5. If you're using minification (for example, like with ProGuard or Dexguard), you need to add `newrelic.properties` file to your app-level directory (_projectname/app_). This step only applies to ProGuard and DexGuard users.

   ```ini
   com.newrelic.application_token=GENERATED_TOKEN
   ```

   To finish set up for minification, follow the steps in [configure ProGuard or DexGuard for Android apps](/docs/mobile-monitoring/new-relic-mobile-android/install-configure/configure-proguard-or-dexguard-android-apps).

6. Clean your project, then run your app in an emulator or device to generate traffic. Wait a few minutes as your agent captures that data.

7. View your data for your Android app. Go to <DNT>**[one.newrelic.com > All capabilities](https://one.newrelic.com/all-capabilities) > Mobile > (select an app)**</DNT>.


## Configure the Android agent for Gradle Plugin Portal [#plugin-portal]

Starting with agent version 7.6.0, the Android agent plugin is available on the [Gradle Plugin Portal](https://plugins.gradle.org/) as a community plugin. The Gradle plugin DSL simpifies adding plugin dependencies to apps. 

   <CollapserGroup>

     <Collapser
       id="project-level"
       title="Project level `build.gradle(.kts)`file:"
     >
       In this example, `AGENT_VERSION` represents your agent version number. See the [agent release notes](/docs/release-notes/mobile-release-notes/android-release-notes), and use the latest version.

       ```groovy
       plugins {
         // for binary Gradle plugins that need to be resolved
         id("com.newrelic.agent.android") version "AGENT_VERSION" apply false
       }
       ```
     </Collapser>

     <Collapser
       id="app-level"
       title="App level `build.gradle(.kts)` file:"
     >
       In this example, `AGENT_VERSION` represents your agent version number. See the [agent release notes](/docs/release-notes/mobile-release-notes/android-release-notes), and use the latest version.

       ```groovy
       plugins {
         id 'com.newrelic.agent.android'
       }

       dependencies {
         implementation 'com.newrelic.agent.android:android-agent:AGENT_VERSION'
       }
       ```
     </Collapser>
   </CollapserGroup>


### Apply the plugin using the plugins DSL {} block [#plugin-dsl]

The preferred and current approach to declaring plugin dependencies: apps must use the fully qualified form of the plugin id (`com.newrelic.agent.android`) in order to resolve the plugin.


1. Declare the New Relic plugin to the top-level `build.gradle(.kts)` file using the Gradle Plugin Portal plugin ID:

   ```groovy
   plugins {
     // for binary Gradle plugins that need to be resolved
     id("com.newrelic.agent.android") version "AGENT_VERSION" apply false
   }
   ```

2. Apply the plugin to the app-level build file, as well as any other sub-module to be instrumented:

   ```groovy
   plugins {
     id("com.newrelic.agent.android")
   }
   ```


Gradle provides guidance on [Applying plugins using the plugins{} block](https://docs.gradle.org/current/userguide/plugins.html#sec:plugins_block).


### Apply the plugin using the buildscript{} block [#buildscript]

The New Relic Android Agent plugin is co-hosted on MavenCentral, but uses the legacy plugin ID ('newrelic'). Customers who prefer to use the legacy plugin ID must provide the classpath to [MavenCentral](https://mvnrepository.com/artifact/com.newrelic.agent.android/agent-gradle-plugin) to resolve the location of the plugin during builds. 


To prefer MavenCentral over the Gradle Plugin Portal, you need to make the following changes to Gradle files:

1. Add this snippet to your top-level `build.gradle(.kts)` file:
   ```groovy
   buildscript {
     repositories {
       mavenCentral()
     }

     // not required if plugin classpath in resolutionStrategy{} below
     dependencies {
       classpath "com.newrelic.agent.android:agent-gradle-plugin:AGENT_VERSION"
     }
   }
   ```   

2. Add this snippet to your `settings.gradle(.kts)` file through `pluginManagement {}` block:
   ```groovy
   pluginManagement {
     repositories {
       mavenCentral()  // adds repo for NewRelic artifacts
     }
     resolutionStrategy {
       eachPlugin {
         // not required if using `classpath dependency` above
         if (requested.id.id.startsWith("newrelic") || requested.id.id.startsWith("com.newrelic.agent.android"))) {
           useModule("com.newrelic.agent.android:agent-gradle-plugin:${AGENT_VERSION}")
         }
       }
     }
     plugins {
        id("newrelic") apply false
     }
   }
   ```

3. Apply the plugin to the app-level build file, as well as any other submodule to be instrumented:

   ```groovy
   plugins {
     id("newrelic")
   }
   ```


In the above snippets, `AGENT_VERSION` represents your agent version number. We strongly recommend you use the latest agent for set up.


## Android 4.x: Multidex support [#4x-multidex]

Mobile monitoring for Android versions older than Android 5.0 (API level 21) use the Dalvik runtime to execute app code. By default, Dalvik limits apps to a single `classes.dex` bytecode file per APK. To get around this limitation, you must [enable multidex support](https://developer.android.com/studio/build/multidex.html). Then you can use the [multidex support library](https://developer.android.com/tools/support-library/features.html#multidex), which becomes part of the primary DEX file of your app. The library manages access to the additional DEX files and their containing code.

<Collapser
  id="error"
  title="Troubleshoot `java.lang.NoClassDefFoundError`"
>
  When building each DEX file for a multidex app, the build tools perform complex decision making to determine which classes are needed in the primary DEX file so that your app can start successfully. If, during start up, the required classes aren't available in the primary DEX file, your app will crash with the error `java.lang.NoClassDefFoundError`.

  If you see the `java.lang.NoClassDefFoundError` error, then you must [manually specify these additional classes as required](https://developer.android.com/studio/build/multidex.html#keep) in the primary DEX file:

  1. Create a `proguard.multidex.config` file within the `/app` folder of your project. Update `mypackage` to reflect your package name.

     ```profile
     ####################
     # keep class names #
     ####################

     #Keep New Relic in the main dex
     -keep class com.newrelic.** { *; }
     -keep class com.mypackage.activities.** { *; }
     ```

  2. Merge the following code into the app-level `build.gradle` file:

     ```groovy
     android {
       defaultConfig{
         …
         multiDexKeepProguard file("proguard.multidex.config")
       }
     }
     ```

  For more information, see the [Android Developers documentation](https://developer.android.com/studio/build/multidex.html#keep) on declaring classes required in the primary DEX file.
</Collapser>

## What's next?

Congratulations! You've successfully installed the Android agent. You have a few options for next steps:

* Configure agent behavior during Gradle builds with the [New Relic Gradle plugin](/docs/mobile-monitoring/new-relic-mobile-android/install-configure/configure-new-relic-gradle-plugin).
* [Upgrade the Android agent SDK](/docs/mobile-monitoring/new-relic-mobile-android/install-configure/upgrading-new-relic-mobiles-android-sdk) to keep your Android agent up to date.
* Having problems with your Android installation? Follow the [troubleshooting procedures](/docs/mobile-monitoring/new-relic-mobile-android/troubleshoot/no-data-appears-android).
