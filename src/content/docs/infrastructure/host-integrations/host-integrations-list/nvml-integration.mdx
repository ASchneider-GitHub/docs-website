---
title: NVML integration
tags:
  - NVML integration
  - New Relic integrations
metaDescription: Use New Relic infrastructure agent to get a dashboard with nvml metrics.
freshnessValidatedDate: never
---

import infrastructureNVMLDashboard from 'images/infrastructure_screenshot-full_nvml-dashboard.webp'

Integrating NVML with New Relic provides valuable insights into the GPU utilization and performance metrics of your applications and systems, facilitating resource optimization, performance bottleneck identification, and the maintenance of overall stability and efficiency in your environment.

<img
    title="NVML dashboard"
    alt="nvml dashboard"
    src={infrastructureNVMLDashboard}
/>

<figcaption>
After setting up the NVML integration with New Relic, see your data in a dashboard right out of the box. 
</figcaption>

## Set up the NVML integration

Complete the following steps to set up the NVML integration:

<Steps>
    <Step>
## Install the infrastructure agent

To use the NVML integration, you need to first [install the infrastructure agent](/docs/infrastructure/install-infrastructure-agent/get-started/install-infrastructure-agent-new-relic/) on the same host. The infrastructure agent monitors the host itself, while the nvml integration extends your monitoring with data specific to your gpu clusters.
    </Step>
    <Step>
## Configure `nri-prometheus` for NVML [#configure]

1. Create a file named `nri-prometheus-config.yml`: 
    ```shell
    touch /etc/newrelic-infra/integrations.d/nri-prometheus-config.yml
    ```

2. Add the following snippet to your `nri-prometheus-config.yml` file to enable the capture of nvml data:

    ```yml
    integrations:
      - name: nri-prometheus
        config:
          # When standalone is set to false nri-prometheus requires an infrastructure agent to work and send data. Defaults to true
          standalone: false

          # When running with infrastructure agent emitters will have to include infra-sdk
          emitters: infra-sdk

          # The name of your cluster. It's important to match other New Relic products to relate the data.
          cluster_name: "NVML"

          targets:
            - description: Secure etcd example
              urls: ["http://<YOUR_HOST_IP>:<PORT>/metrics"]
          #    tls_config:
          #      ca_file_path: "/etc/etcd/etcd-client-ca.crt"
          #      cert_file_path: "/etc/etcd/etcd-client.crt"
          #      key_file_path: "/etc/etcd/etcd-client.key"

          # Whether the integration should run in verbose mode or not. Defaults to false.
          verbose: false

          # Whether the integration should run in audit mode or not. Defaults to false.
          # Audit mode logs the uncompressed data sent to New Relic. Use this to log all data sent.
          # It does not include verbose mode. This can lead to a high log volume, use with care.
          audit: false

          # The HTTP client timeout when fetching data from endpoints. Defaults to "5s" if it is not set.
          # This timeout in seconds is passed as well as a X-Prometheus-Scrape-Timeout-Seconds header to the exporters
          # scrape_timeout: "5s"

          # Length in time to distribute the scraping from the endpoints. Default to "30s" if it is not set.
          scrape_duration: "5s"

          # Number of worker threads used for scraping targets.
          # For large clusters with many (>400) endpoints, slowly increase until scrape
          # time falls between the desired `scrape_duration`.
          # Increasing this value too much will result in huge memory consumption if too
          # many metrics are being scraped.
          # Default: 4
          # worker_threads: 4

          # Whether the integration should skip TLS verification or not. Defaults to false.
          insecure_skip_verify: false

        timeout: 10s
    ```
    </Step>
    <Step>
## Restart the infrastructure agent [#restart-infra]

Use the instructions in our [infrastructure agent docs](/docs/infrastructure/install-infrastructure-agent/manage-your-agent/start-stop-restart-infrastructure-agent/) to restart your infrastructure agent. This is a basic command that should work for most people:

    ```shell
    sudo systemctl restart newrelic-infra.service
    ```
    </Step>
    <Step>

## View your nvml metrics in New Relic [#view-data]

Once you've completed the setup above, you can view your metrics using our pre-built dashboard template. To access this dashboard:

1. Go to **[one.newrelic.com](https://one.newrelic.com/) > + Add data**.
2. Click on the **Dashboards** tab.
3. In the search box, type `nvml`.
4. Select it and click **Install**.

To instrument the nvml quickstart and to see metrics and alerts, you can also follow our [NVML quickstart page](https://newrelic.com/instant-observability/nvml) by clicking on the `Install now` button.

Here's an example query to check the number of devices in GPU:

```sql
SELECT latest(nvml_device_count) FROM Metric
```      
    </Step>
</Steps>

## What's next? [#whats-next]

To learn more about building NRQL queries and generating dashboards, check out these docs:

* [Introduction to the query builder](/docs/query-your-data/explore-query-data/query-builder/introduction-query-builder) to create basic and advanced queries.
* [Introduction to dashboards](/docs/query-your-data/explore-query-data/dashboards/introduction-dashboards) to customize your dashboard and carry out different actions.
* [Manage your dashboard](/docs/query-your-data/explore-query-data/dashboards/manage-your-dashboard) to adjust your <InlinePopover type="dashboards" /> display mode, or to add more content to your dashboard.
