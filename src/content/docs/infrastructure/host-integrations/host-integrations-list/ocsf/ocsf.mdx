---
title: OCSF integration
tags:
    - New Relic integrations
    - OCSF integration
metaDescription: Use New Relic infrastructure agent to get a dashboard with metrics from your OCSF format data.
freshnessValidatedDate: 2024-05-20
---
import ocsfDashboard from 'images/ocsf-dashboard.webp'


Monitor OCSF data seamlessly with New Relic for comprehensive insights into security-related data from various sources, facilitating threat detection, incident response, and compliance. 

<img
    title="OCSF dashboard"
    alt="OCSF dashboard"
    src={ocsfDashboard}
/>
<figcaption>
After setting up our OCSF integration, we give you a dashboard for your OCSF metrics. 
</figcaption>


<Steps>
    <Step>
## Install the infrastructure agent [#infra-install]

To use the OCSF integration, you need to also [install the infrastructure agent](/docs/infrastructure/install-infrastructure-agent/get-started/install-infrastructure-agent-new-relic/) on the same host. The infrastructure agent monitors the host itself, while the integration you'll install in the next step extends your monitoring with OCSF-specific data.
    </Step>
    <Step>

## Enable the OCSF integration with nri-flex

To set up the OCSF integration, follow these steps:

1. Create a file named `nri-ocsf.yml` in the integrations directory:

  ```shell
  touch /etc/newrelic-infra/integrations.d/nri-ocsf.yml
  ```

2. Add the following snippet to your `nri-ocsf.yml` file to enable the agent to capture OCSF data:
  ```yml
    integrations:
    - name: nri-flex
        # interval: 30s
        config:
        name: ocsfExampleE
        global:
            base_url: https://schema.ocsf.io/sample/
            headers:
            accept: application/json
        apis:
            - event_type: ocsfBaseEvent
            url: classes/base_event
            - event_type: ocsfComplianceFinding
            url: classes/compliance_finding
            - event_type: ocsfScanActivity
            url: classes/scan_activity
            - event_type: ocsfDataSecurityFinding
            url: classes/data_security_finding
            - event_type: ocsfBaseEvent
            url: classes/base_event
            - event_type: ocsfApplicationLifecycle
            url: classes/application_lifecycle
            - event_type: ocsfDhcpActivity
            url: classes/dhcp_activity
            - event_type: ocsfScheduledJobActivity
            url: classes/scheduled_job_activity
            - event_type: ocsfNetworkFileActivity
            url: classes/network_file_activity
            - event_type: ocsfDnsActivity
            url: classes/dns_activity
            - event_type: ocsfProcessQuery
            url: classes/process_query
            - event_type: ocsfFolderQuery
            url: classes/folder_query
            - event_type: ocsfFileHosting
            url: classes/file_hosting
            - event_type: ocsfRemediationActivity
            url: classes/remediation_activity
            - event_type: ocsfSecurityFinding
            url: classes/security_finding
            - event_type: ocsfPeripheralDeviceQuery
            url: classes/peripheral_device_query
            - event_type: ocsfHttpActivity
            url: classes/http_activity
            - event_type: ocsfEntityManagement
            url: classes/entity_management
            - event_type: ocsfModuleActivity
            url: classes/module_activity
            - event_type: ocsfServiceQuery
            url: classes/service_query
            - event_type: ocsfMemoryActivity
            url: classes/file_remediation_activity
  ```
    </Step>
    <Step>

## Forward OCSF logs

Follow these steps to forward OCSF logs to New Relic:

1. Edit the log file named `logging.yml` located at the following path:

  ```shell
  cd /etc/newrelic-infra/logging.d
  ```

2. Add the following snippet to the `logging.yml` file. Replace `file` with your OCSF log filepath if needed:

  ```yml
  logs:
    - name: syslog
      file: /var/log/ocsf
      attributes:
        logtype: ocsf
  ``` 
      
    </Step>
    <Step>
## Restart the New Relic infrastructure agent

Restart your infrastructure agent:

  ```shell
  sudo systemctl restart newrelic-infra.service
  ```

In a couple of minutes, your application will begin sending metrics to [one.newrelic.com](https://one.newrelic.com).        
    </Step>
    <Step>
## Find your data 

You can use our pre-built dashboard template to monitor your OCSF application metrics. Follow these steps to use our pre-built dashboard template:

1. From [one.newrelic.com](https://one.newrelic.com), go to the <DoNotTranslate>**+ Add data**</DoNotTranslate> page
2. Click on <DoNotTranslate>**Dashboards**</DoNotTranslate>
3. In the search bar, type `OCSF`
4. The OCSF dashboard should appear. Click on it to install it

Your OCSF dashboard is considered a custom dashboard and can be found in the <DoNotTranslate>**Dashboards**</DoNotTranslate> UI. For docs on using and editing dashboards, see [our dashboard docs](/docs/query-your-data/explore-query-data/dashboards/introduction-dashboards).

Here is an example NRQL query to view the OCSF master uptime:

```sql
SELECT * FROM ocsfSecurityFinding
```        
    </Step>
</Steps>

## What's next?

To learn more about building NRQL queries and generating dashboards, check out these docs:

* [Introduction to the query builder](/docs/query-your-data/explore-query-data/query-builder/introduction-query-builder) to create basic and advanced queries.
* [Introduction to dashboards](/docs/query-your-data/explore-query-data/dashboards/introduction-dashboards) to customize your dashboard and carry out different actions.
* [Manage your dashboard](/docs/query-your-data/explore-query-data/dashboards/manage-your-dashboard) to adjust your dashboards display mode, or to add more content to your dashboard.