---
title: "NerdGraph tutorial: Secret Management Service"
metaDescription: "Learn how to use the Secret Management Service to securely store and manage your secrets."
freshnessValidatedDate: never
---

<Callout title="preview">
  We're still working on this feature, but we'd love for you to try it out!

  This feature is currently provided as part of a preview program pursuant to our [pre-release policies](/docs/licenses/license-information/referenced-policies/new-relic-pre-release-policy).
</Callout>

The Secret Management Service is a secure and scalable way to store and manage your secrets. It provides a centralized location for storing and managing secrets, such as API keys to reduce fragmentation and complexity across different services in New Relic. 
You can store any string value as a secret, and call them programatically during runtime.

Note that there's no data boundary for storing secrets; all secrets reside in US in a global DB enclave.

Use the [NerdGraph API](https://docs.newrelic.com/docs/apis/nerdgraph/get-started/introduction-new-relic-nerdgraph/) to interact with the Secret Management Service. This tutorial will guide you through the process of creating, updating, and deleting secrets using the Secret Management Service.

## Key features

* **Centralized Repository**: Store all your confidential keys and credentials in one secure location.
* **Secure Management**: Enhanced security features to protect your secrets.
* **Scalability**: Designed to handle the growing needs of enterprises.

## Requirements[#review-requirements]
 
* You need a [New Relic account](https://newrelic.com/signup), and with that account, you can access your API user key that you need to include with queries and mutations.

* User type and assigned roles can affect your NerdGraph permissions. For more details, see [Factors affecting access](https://docs.newrelic.com/docs/accounts/accounts-billing/account-structure/factors-affecting-access-features-data/#user-permissions).

## Mutation operations

To enable users to interact with the Secrets Management Service, following are the exposed four NerdGraph mutations:


### Create a secret[#create-secret]

The `secretsManagementCreateSecret` mutation allows you to add new secrets to the Secrets Management Service.

#### Input Parameters

* `accountId` (String, required): The account ID associated with the secret.
* `alias` (String, optional): An alias for the secret.
* `entityGuid` (String, optional): The entity GUID associated with the secret.
* `key` (String, required): The key for the secret.
* `namespace` (String, required): The namespace to which the secret belongs.
* `value` (SecureValue, required): The value of the secret.

#### Response

* `createdAt` (String): The time the secret was created.
* `updatedAt` (String): The time the secret was last updated.
* `key` (String): The key of the created secret.
* `latestVersion` (String): The version of the created secret.
* `tags` (Array): Metadata associated with the secret.

#### Sample query:

```graphql
mutation {
  secretsManagementCreateSecret(
    accountId: 12345678
    key: "test_user_key"
    value: "1234567890"
    alias: ""
    entityGuid: ""
    namespace: ""
  ) {
    createdAt
    latestVersion
    updatedAt
  }
}

```
#### Smaple response:
    
    ```json
    {
    "data": {
        "secretsManagementCreateSecret": {
        "createdAt": "2021-09-29T10:00:00Z",
        "latestVersion": "1",
        "updatedAt": "2021-09-29T10:00:00Z"
        }
    }
    }
    ```


### Purge secrets[#purge-secrets]

The `secretsManagementPurgeSecret` mutation allows you to delete secrets from the Secrets Management Service. You can delete a specific version of a secret or all versions of a secret.

#### Input Parameters

* `accountId` (String, required): The account ID associated with the secret.
* `key` (String, required): The key for the secret.
* `namespace` (String, optional): The namespace to which the secret belongs.
* `purgeAll` (Boolean, required): If true, all versions of the secret are deleted. 
* `version` (String, optional): The version of the secret to delete.

<Callout variant="tip">
    * If `purgeAll` is true, the `version` parameter is null and ignored.
    * valid combination of `purgeAll` and `version` : `true` & `null`, `false` & `non-null`.
</Callout>

#### Response

* `key` (String): The key of the created secret.
* `latestVersion` (String): The latest version available corresponding to the key. If `purgeAll` is true or no version is available after purge, latestVersion will be null.
* `tags` (Array): Metadata associated with the secret.

#### Sample query:

```graphql

mutation {
  secretsManagementPurgeSecret(
    accountId: 12345678
    key: "test_user_key"
    namespace: ""
    purgeAll: true
    version: ""
  ) {
    key
    latestVersion
    tags
  }
}

```

#### Sample response:

```json
{
  "data": {
    "secretsManagementPurgeSecret": {
      "latestVersion": null
    }
  },
}
```


### Retrive a secret[#retrieve-secret]

The `secretsManagementRetrieveSecret` mutation allows you to access the value of stored secrets.

#### Input Parameters

* `accountId` (String, required): The account ID associated with the secret.
* `namespace` (String, optional): The namespace to which the secret belongs.
* `key` (String, required): The key of the secret that needs to be retrieved.
* `version`(String, required): The version of the secret that needs to be retrieved.

#### Response

* `value` (SecureValue, required): The value of the secret.
* `tags` (Array): Metadata associated with the secret.
* `createdAt` (String): The time the secret was created.

#### Sample query:

```graphql
query {
  secretsManagementRetrieveSecret(
    namespace: "test"
    key: "test_user_key"
    version: ""
  ) {
    value
    tags
    createdAt
  }
}
```

#### Sample response:

```json
{
  "data": {
    "secretsManagementRetrieveSecret": {
      "value": "1234567890",
      "tags": [],
      "createdAt": "2021-09-29T10:00:00Z"
    }
  }
}
```


### Update a secret[#update-secret]

The `secretsManagementUpdateSecret` mutation allows you to update the value of existing secrets.

#### Input Parameters

* `accountId` (String, required): The account ID associated with the secret.
* `namespace` (String, optional): The namespace to which the secret belongs.
* `key` (String, required): The key of the secret that needs to be updated.
* `value` (String, required): The secret value that you want to update.

#### Response

* `createdAt` (String): The time the secret was created.
* `updatedAt` (String): The time the secret was last updated.
* `key` (String): The key of the created secret.
* `latestVersion` (String): The version of the created secret.

#### Sample query:

```graphql
mutation {
  secretsManagementUpdateSecret(
    namespace: "test"
    key: "test_user_key"
    value: "1234567890"
  ) {
    key
    latestVersion
    createdAt
    updatedAt
  }
}
```

#### Sample response:

```json
{
  "data": {
    "secretsManagementUpdateSecret": {
      "createdAt": "2024-10-21T08:01:07.593140Z",
      "latestVersion": 0,
      "updatedAt": "2024-10-21T08:03:26.334448074Z"
    }
  },
}
```












